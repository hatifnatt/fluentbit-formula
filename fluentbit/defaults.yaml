fluentbit:
  install: false
  lookup:
    path_prefix: templates
  version: 4.2.0
  use_upstream: repo # package, repo. Other variants are not implemented
  # Fluent Bit is not available in most OS system repositories
  # therefor official repository is almost mandatory
  use_official_repo: true
  root_user: root
  root_group: root
  # default config is useless therefor service also disabled by default
  service:
    name: fluent-bit
    # running / dead
    status: dead
    # enabled / disabled
    on_boot_state: disabled
    # perform reload instead of restart
    reload: true
    args: []
  package:
    prereq_pkgs: []
    pkgs_extra: []
    pkgs:
      - fluent-bit
    hold: false
    update_holds: true
    install_recommends: true
    # reference variable
    # official package install binary into the /opt so it's not available in PATH
    bin: /opt/fluent-bit/bin/fluent-bit
  # Logrotate configuration
  logrotate:
    enable: true
    package:
      install: true
      pkgs:
        - logrotate
    config:
      rotate: 7
      # Uncomment and set size if needed
      # maxsize: 100M
      # Uncomment and set script if needed
      # postrotate_script: ""
  # check os*.yaml files for details / examples of repo configuration
  repo: {}
  conf_dir: /etc/fluent-bit
  storage_dir: &storage_dir /var/lib/fluent-bit/storage
  db_dir: /var/lib/fluent-bit/db
  logs_dir: /var/log/fluent-bit
  # add `--quiet` argument when running configuration check - `--dry-run`
  # fluent-bit -c /etc/fluent-bit/fluent-bit.conf --dry-run --quiet
  # this will hide version info and large banner and only print check results
  # NB Dry Run can miss errors in configuration files!
  quiet_config_check: true
  # yaml / classic
  # conf_type: yaml
  main_config:
    # switching to yaml config by default
    name: fluent-bit.yaml
    source: ''
    path_prefix: 'templates'
    # configuration to pass to template file, `config` variable will be available inside template
    # for yaml config it must be dictionary, for classic config it's expected to be multiple strings
    config:
      service:
        # For the logrotate configuration to work, the log file must be named fluent-bit.log
        # and saved in the directory specified in the `logs_dir`
        log_file: /var/log/fluent-bit/fluent-bit.log
        # only minimum configuration related to storage
        # NB it's you responsibility to correctly specify same path in formula `storage_dir` parameter
        # and in Fluent Bit `storage.path` configuration parameter
        # when both parameters are defined in same pillar (yaml) file
        # it's possible to use YAML anchors to keep things more DRY
        storage.path: *storage_dir
        storage.sync: normal
        storage.metrics: true
    ## yaml config
    # config:
    #   service:
    #     flush: 1
    #    ...
    ## classic config
    # config: |
    #   [SERVICE]
    #       flush        1
    #   ...
  configs_unmanaged_purge: false
  configs: {}
    # recommended sub directories for various configuration types
    # parsers: {}
    # inputs: {}
    # filters: {}
    # outputs: {}
  # relative to `conf_dir`
  lua_scripts_dir: lua
  lua_scripts_unmanaged_purge: false
  lua_scripts: {}
